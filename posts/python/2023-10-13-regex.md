---
layout: post
category: Python
tags: ['textmining']
date: 2023-10-13

title: Text with Python - Regular Expression
author: Akai Red
description:
    정규표현식은 특정한 규칙을 가진 문자열의 집합을 표현하는데 사용한다. 
image:
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20231013_img1
optimized_image:
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_380,h_200,r_5,f_auto,q_auto/lrc/20231013_img1

show_thumbnail: true
math: true
published: true
---

## Regular Expression
정규표현식*Regular Expression*은 특정한 규칙을 가진 문자열의 집합을 표현하는데 사용한다. 정규표현식을 잘 사용하면 복잡한 문자열의 검색과 치환을 쉽게 할 수 있다.


## Metacharacters
메타문자*metacharacters*는 정규표현식에 사용할 때 특수한 의미를 가지는 문자를 뜻한다. 메타문자를 사용하면 특정한 문자열을 찾거나 치환할 수 있다. 주로 사용하는 메타문자는 다음과 같다:  

### Dots
- `.`: 어떤 단일 문자와 일치한다.  
  *ex* `a.b`는 `axb`, `aab`, `a1b`와 일치하지만 `a\nb`와는 일치하지 않는다.  
  ※ 메일주소는 정규표현식에서 `@gmail.com`이 아닌 `@gmail[.]com`과 같이 사용한다.

### Anchors 
- `$`: 줄의 끝과 일치한다.  
  *ex* `foo$`는 `foo`와 일치하지만 `foobar`와는 일치하지 않는다.

- `^`: 줄의 시작과 일치한다.  
  *ex* `^foo`는 `foo`와 일치하지만 `barfoo`와는 일치하지 않는다.

### Quantifiers
- `*`: (반복 0회 이상) 바로 앞의 문자의 0회 이상 발생을 일치한다.    
  *ex* `a*b`는 `b`, `ab`, `aaab`와 일치하지만 `ac`와는 일치하지 않는다.

- `+`: (반복 1회 이상) 바로 앞의 문자의 1회 이상 발생을 일치한다.    
  *ex* `a+b`는 `ab`, `aaab`와 일치하지만 `b`와는 일치하지 않는다.  
  
- `?`: 바로 앞의 문자의 0회 또는 1회 발생을 일치한다.    
  *ex* `a?b`는 `b`, `ab`와 일치하지만 `aab`와는 일치하지 않는다.  

- `{}`: 중괄호 내에 나열된 문자의 횟수를 지정한다.  
  *ex* `a{2,3}b`는 `aab`, `aaab`와 일치하지만 `ab`와는 일치하지 않는다.

### Alternation
- `|`: 논리 OR처럼 작동하며, 파이프 앞 또는 뒤의 표현식 중 하나와 일치한다.  
  *ex* `a|b`는 `a` 또는 `b`와 일치한다.

### Grouping
- `()`: 문자나 하위 패턴을 그룹화한다.  
  *ex* `(ab)+`는 `ab`, `abab`, `ababab`와 일치한다.

### Character Classes
- `[]`: 대괄호 내에 나열된 문자 중 하나와 일치하는 문자 클래스를 정의한다.  
  *ex* `[abc]`는 `a`, `b`, `c`와 일치한다. `[0-9]`는 숫자와 일치한다.  

    - `\d`: 숫자와 일치한다. (=`[0-9]`)
    - `\D`: 숫자가 아닌 문자와 일치한다. (=`[^0-9]`)
    - `\s`: 공백 문자와 일치한다. (=`[ \t\n\r\f\v]`)
    - `\S`: 공백 문자가 아닌 문자와 일치한다. (=`[^ \t\n\r\f\v]`)
    - `\w`: 알파벳 문자와 숫자와 일치한다. (=`[a-zA-Z0-9_]`)
    - `\W`: 알파벳 문자와 숫자가 아닌 문자와 일치한다. (=`[^a-zA-Z0-9_]`)
- `[^]`: 대괄호 안의 `^`는 줄의 시작이 아닌 NOT을 의미한다.

### Escape Character
- `\`: 메타문자의 특수한 기능을 무시하고 문자 그 자체와 일치한다.  
  *ex* `a\.b`는 `a.b`와 일치한다.

## Python re module
### compile
```python
import re                   # re 모듈 import
p = re.compile('[a-z]+')    # 정규표현식 컴파일
```
Python에서 정규표현식을 사용하기 위해서는 `re` 모듈을 import해야 한다. `re` 모듈을 import한 후, `re.compile()` 함수를 사용해 정규표현식을 컴파일한다. 컴파일된 정규표현식은 `match()`, `search()`, `findall()`, `finditer()` 함수와 함께 사용할 수 있다.

### match
```python
m1 = p.match('python3')     # <re.Match object; span=(0, 6), match='python'>
m2 = p.match('3 python')    # None
```
`p.match()`는 문자열의 처음부터 확인하여 정규식 패턴 `p`와 일치하는지 확인한다. 확인 결과 일치하면 `match` 객체를, 일치하지 않으면 `None`을 반환한다.

### search
```python
s = p.search('3 python')    # <re.Match object; span=(2, 8), match='python'>
s.group()                   # 'python'
```
`p.search()`는 문자열 전체를 확인하여 정규식 패턴 `p`와 일치하는지 확인한다. `'3 python'`는 `.match()`를 사용했을 때는 `None` 값을 반환했지만, `.search()`를 사용할 경우 `match` 객체를 반환한다. `p.match()`와의 차이점은 문자열의 처음부터 확인하는 것이 아니라 문자열 전체를 확인한다는 것이다.

### findall
```python
p = re.compile('[a-z]+')
p.findall('life is too short')  # ['life', 'is', 'too', 'short']
```
`p.findall()`은 정규식과 매치되는 일부 문자열을 리스트 형태로 제공한다. `p.findall()`은 `p.search()`와 달리 매치되는 문자열을 하나만 반환하는 것이 아니라 매치되는 모든 문자열을 리스트 형태로 반환한다.

### finditer
```python
p = re.compile('[a-z]+')
result = p.finditer('life is too short')
for r in result:
    print(r)    # <re.Match object; span=(0, 4), match='life'>
                # <re.Match object; span=(5, 7), match='is'>
                # <re.Match object; span=(8, 11), match='too'>
                # <re.Match object; span=(12, 17), match='short'>
```
`p.finditer()`는 정규식과 매치되는 모든 문자열을 반복 가능한 객체로 제공한다. `p.findall()`과 달리 매치되는 문자열을 리스트 형태로 반환하는 것이 아니라 매치되는 모든 문자열을 반복 가능한 객체로 반환한다. 반복 가능한 객체의 각각의 요소는 `match` 객체이다.

### sub, split
```python
sample = '   This   is  a sample   text. '

text = re.sub(r'\s+', ' ', sample) # 1개 이상이 공백을 공백으로 바꾼다.
print(text) # This is a sample text. 

text = re.split(r'\s+', sample) # 1개 이상이 공백을 기준으로 문자열을 나눈다.
print(text) # ['This', 'is', 'a', 'sample', 'text.', '']
```
`re.sub(prev, new, string)` 함수는 정규표현식을 사용해 특정 문자열을 바꿔준다. 정규표현식 버전의 `str.replace()`라고 할 수 있다. `re.split(prev, string)` 함수는 정규표현식을 사용해 문자열을 나눈다. 정규표현식 버전의 `str.split()`라고 할 수 있다.


## References
* [[Java] 정규표현식(RegExp) 이해하기 : 패턴, 문자 클래스, 자주 사용 패턴](https://adjh54.tistory.com/104#1.%20%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%20%ED%8C%A8%ED%84%B4(Regular%20Expression%20Pattern)-1)
* [점프 투 파이썬 / 08장 정규표현식 / 08-2 정규 표현식 시작하기](https://wikidocs.net/4308#search)
* [Regular Expression (Regex) Syntax](https://www.tutorialsteacher.com/regex/regex-syntax)