---
layout: post
category: Python
tags: ['python']
date: 2021-03-30

title: pickle을 사용해 파이썬 객체 상태로 저장하기
author: Akai Red
description:
    보통 분석결과는 csv파일로 저장한다. 히지만 pickle을 사용하면 파이썬 객체를 그대로 저장할 수 있다.
image:
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20210330_img2
optimized_image:
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_380,h_200,r_5,f_auto,q_auto/lrc/20210330_img2

show_thumbnail: true
math: true
published: true
---

pickle을 사용하면 분석결과를 파이썬 객체 형식 그대로 저장할 수 있다. 분석 과정에서 나오는 pandas 데이터프레임, numpy배열 등 특정 파이썬 객체를 csv형태로 변환하여 저장하곤 한다. 작은 데이터는 문제가 없지만 데이터 사이즈가 커지면 csv 변환도 일이다. 2차원 이상 고차원 데이터를 저장하는데도 csv는 적합하지 않다. 대신 pickle 패키지를 사용해보자.


## import pickle as pkl: 피클 패키지 불러오기
```python
import pickle as pkl
```
pickle은 이진 형식으로 파일을 저장하기 때문에 압축률이 좋아 저장하는데 걸리는 시간이 짧다. 또한 객체 형식 그대로 저장한다. 딕셔너리, 데이터프레임 등 다양한 객체를 그대로 저장할 수 있다. 


## pkl.dump(객체, 파일): 피클 저장하기
```python
with open('파일 주소', 'wb') as fw:
    pkl.dump(객체, fw)
```
pickle을 사용해서 저장하는 방법은 다음과 같다. `파일 주소`에 저장하고 싶은 위치 + 파일명을 넣어준다. 파일명은 `.pickle`로 하는 경우도 있고 `.bin`으로 하는 경우도 있다. 확장자명을 쓰지 않고 파일명만 써도 된다. `wb`조건은 이진 형식으로 쓰겠다는 것을 의미한다(write binary). 이진 형식으로 저장하기 때문에 압축률이 좋다.

```python
with open('파일 주소', 'w') as f:
    f.write(text)
```
pickle을 사용하지 않는 일반적인 텍스트 저장은 다음과 같다. 복잡한 형식의 파일은 전용 패키지를 쓰는 것이 유리하기 때문에, 텍스트 파일을 저장하고 불러오는 정도로 사용한다.


## pkl.load(파일): 피클 꺼내기
```python
with open('파일 주소', 'rb') as fr:
    result = pkl.load(fr)
```
고사양 컴퓨터에서 몬테카를로 시뮬레이션을 돌리고 결과는 노트북으로 분석하고 싶을 때 pickle을 사용해보자. 위의 두줄의 코드만으로 간단하게 결과를 열 수 있다. 저장할 때와 다르게 꺼낼 때는 `rb`라고 적어줘야 한다. 이진 형식으로 읽어온다는 뜻이다(read binary).

```python
with open('파일 주소', 'r') as f:
    text = f.read()
```
pickle을 사용하지 않는 일반적인 텍스트 불러오기는 다음과 같다. `f.read()` 외에 `f.readline()`, `f.readlines()` 등 다른 메서드를 사용할 수도 있다.