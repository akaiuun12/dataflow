---
layout: post
category: web
tags: ['GA']

date: 2022-02-09
author: Akai Red
title: Google Analytics 추가하기
description: 
    구글 애널리틱스 서비스를 이용하면 사이트에 관한 다양한 정보를 얻을 수 있다.

image: 
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20220209_img4
optimized_image: 
    https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_380,h_200,r_5,f_auto,q_auto/lrc/20220209_img4

show_thumbnail: true
math: true
published: true
---

GitHub Pages, Netlify 등의 호스팅 서비스가 항상 방문자 수 통계를 제공하진 않는다. 방문자 수를 아는 다양한 방법이 있는데 가장 많이 사용되는 것은 구글 애널리틱스(Google Analytics; GA) 서비스를 이용하는 것이다. 물론 GA는 그 외에도 더 많은 기능을 제공한다.


## GA 가입하기
[Google Analytics](https://analytics.google.com/)로 들어가서 계정을 먼저 만들어야 한다. GA를 가입할 때 주는 측정 ID를 잘 알아두자. 이미 가입한 사람은 아래와 같은 방법으로 확인할 수 있다.


## 측정 ID 확인
![GA Sign-In Step 1](https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20220209_img1)

주황색 화살표를 눌러서 관리 - 계정 - 속성 순으로 들어온다. 속성의 데이터 스트림을 눌러준다. 

![GA Sign-In Step 2](https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20220209_img2)

데이터 스트림을 누르면 블로그 이름과 주소가 보일 것이다. 자신의 블로그를 눌러준다.

![GA Sign-In Step 3](https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20220209_img3)

웹 스트림 세부정도의 우측 상단 빨간 화살표가 가리키는 부분이 측정 ID다. 블로그 고유의 주소이며 이 ID를 사용해 GA는 방문자 유입 등을 추적한다.


## 측정 ID 적용
측정 ID를 안 것만으로는 GA가 동작하지 않는다. 자신의 블로그에 적용해줘야 한다. 최신의 정적사이트 생성기*SSG* 테마들은 대부분 GA 플러그인을 탑재하고 있기 때문에 설정 파일에서 ID를 수정해주면 바로 적용할 수 있다. 

### Jekyll
```yml
google_analytics: G-XXXXXXXXXX
```  
[Jekyll minima 테마](https://github.com/jekyll/minima)는 아래 코드를 `_config.yml` 파일에 추가하면 자동적으로 GA가 적용된다. 철자를 틀리지 않도록 주의하자. G뒤에는 10자리 코드가 온다. minima 페이지 설명은 UA로 시작하는 구버전 코드로 되어있으나 G로 시작하는 최신 버전도 되는 것을 확인했다.


### Gatsby
```sh
npm install gatsby-plugin-google-gtag
```  
```js
// 0. gatsby-plugin-google-gtag: This plugin adds Google Analytics gtag.js to a site.
    {
      resolve: `gatsby-plugin-google-gtag`,
      options: {
        // You can add multiple tracking ids and a pageview event will be fired for all of them.
        trackingIds: [
          "G-XXXXXXXXXX", // Google Analytics / GA
          // "AW-CONVERSION_ID", // Google Ads / Adwords / AW
          // "DC-FLOODIGHT_ID", // Marketing Platform advertising products (Display & Video 360, Search Ads 360, and Campaign Manager)
        ],
        // This object is used for configuration specific to this plugin
        pluginConfig: {
          // Puts tracking script in the head instead of the body
          head: true,
        },
      },
    },
```
Gatsby에서는 `gatsby-plugin-google-gtag` 플러그인을 사용해서 쉽게 GA를 적용할 수 있다. `npm` 명령어로 해당 플러그인을 설치하고 `gatsby-config.js`를 수정해주자. 중요한 부분은 `trackingIds`로 G뒤 10자리 코드를 입력해주자.


## head 태그 수정 (optional)
테마 자체적으로 GA를 지원하지 않는다면 아래 코드를 `<head>` 태그에 직접 적용할 수도 있다. 보통 `default.html`에 추가하거나 `google-analytics.html`의 별도 파일을 만들어 include하는 방식으로 사용한다. 중간에 G로 시작하는 코드를 자신의 측정 ID로 바꿔준다. 아래 코드는 측정 ID를 확인한 GA 페이지에서도 확인할 수 있다.

```html
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXXXXXXXXX');
</script>
```


## 적용 확인
![GA Sign-In Step 4](https://res.cloudinary.com/dhchweuhy/image/upload/c_fill,w_760,h_399,r_5,f_auto,q_auto/lrc/20220209_img4)

다시 [Google Analytics](https://analytics.google.com/)로 들어가보자. 자신의 블로그에 들어가본 뒤 GA 페이지에서 위 화면처럼 방문자 집계가 제대로 되는 것을 확인하면 성공이다.


## References
* [Google Analytics](https://analytics.google.com/)
* [Jekyll 블로그에 Google Analytics 붙이기 (GA4 기준)](https://kim-eun-ji.github.io/etc/2021-05-18-ga/)